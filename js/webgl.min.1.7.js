glMatrixArrayType="undefined"!=typeof Float32Array?Float32Array:"undefined"!=typeof WebGLFloatArray?WebGLFloatArray:Array;
var vec3={create:function(a){var b=new glMatrixArrayType(3);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},add:function(a,b,c){if(!c||a==c)return a[0]+=b[0],a[1]+=b[1],a[2]+=b[2],a;c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];return c},subtract:function(a,b,c){if(!c||a==c)return a[0]-=b[0],a[1]-=b[1],a[2]-=b[2],a;c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c},negate:function(a,b){b||(b=a);b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b},scale:function(a,
b,c){if(!c||a==c)return a[0]*=b,a[1]*=b,a[2]*=b,a;c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;return c},normalize:function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],g=Math.sqrt(c*c+d*d+e*e);if(g){if(1==g)return b[0]=c,b[1]=d,b[2]=e,b}else return b[0]=0,b[1]=0,b[2]=0,b;g=1/g;b[0]=c*g;b[1]=d*g;b[2]=e*g;return b},cross:function(a,b,c){c||(c=a);var d=a[0],e=a[1];a=a[2];var g=b[0],f=b[1];b=b[2];c[0]=e*b-a*f;c[1]=a*g-d*b;c[2]=d*f-e*g;return c},length:function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*
a)},dot:function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},direction:function(a,b,c){c||(c=a);var d=a[0]-b[0],e=a[1]-b[1];a=a[2]-b[2];b=Math.sqrt(d*d+e*e+a*a);if(!b)return c[0]=0,c[1]=0,c[2]=0,c;b=1/b;c[0]=d*b;c[1]=e*b;c[2]=a*b;return c},lerp:function(a,b,c,d){d||(d=a);d[0]=a[0]+c*(b[0]-a[0]);d[1]=a[1]+c*(b[1]-a[1]);d[2]=a[2]+c*(b[2]-a[2]);return d},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"}},mat3={create:function(a){var b=new glMatrixArrayType(9);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=
a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,b){if(!b||a==b){var c=a[1],d=a[2],e=a[5];a[1]=a[3];a[2]=a[6];a[3]=c;a[5]=a[7];a[6]=d;a[7]=e;return a}b[0]=a[0];b[1]=a[3];b[2]=a[6];b[3]=a[1];b[4]=a[4];b[5]=a[7];b[6]=a[2];b[7]=a[5];b[8]=a[8];return b},
toMat4:function(a,b){b||(b=mat4.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=0;b[4]=a[3];b[5]=a[4];b[6]=a[5];b[7]=0;b[8]=a[6];b[9]=a[7];b[10]=a[8];b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"}},mat4={create:function(a){var b=new glMatrixArrayType(16);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=
a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},transpose:function(a,b){if(!b||a==b){var c=a[1],d=a[2],e=a[3],g=a[6],f=a[7],h=a[11];a[1]=a[4];a[2]=
a[8];a[3]=a[12];a[4]=c;a[6]=a[9];a[7]=a[13];a[8]=d;a[9]=g;a[11]=a[14];a[12]=e;a[13]=f;a[14]=h;return a}b[0]=a[0];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=a[1];b[5]=a[5];b[6]=a[9];b[7]=a[13];b[8]=a[2];b[9]=a[6];b[10]=a[10];b[11]=a[14];b[12]=a[3];b[13]=a[7];b[14]=a[11];b[15]=a[15];return b},determinant:function(a){var b=a[0],c=a[1],d=a[2],e=a[3],g=a[4],f=a[5],h=a[6],k=a[7],j=a[8],l=a[9],m=a[10],p=a[11],n=a[12],q=a[13],r=a[14];a=a[15];return n*l*h*e-j*q*h*e-n*f*m*e+g*q*m*e+j*f*r*e-g*l*r*e-n*l*d*k+j*q*d*k+
n*c*m*k-b*q*m*k-j*c*r*k+b*l*r*k+n*f*d*p-g*q*d*p-n*c*h*p+b*q*h*p+g*c*r*p-b*f*r*p-j*f*d*a+g*l*d*a+j*c*h*a-b*l*h*a-g*c*m*a+b*f*m*a},inverse:function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],g=a[3],f=a[4],h=a[5],k=a[6],j=a[7],l=a[8],m=a[9],p=a[10],n=a[11],q=a[12],r=a[13],t=a[14],u=a[15],C=c*h-d*f,D=c*k-e*f,v=c*j-g*f,w=d*k-e*h,x=d*j-g*h,y=e*j-g*k,z=l*r-m*q,A=l*t-p*q,B=l*u-n*q,E=m*t-p*r,F=m*u-n*r,G=p*u-n*t,s=1/(C*G-D*F+v*E+w*B-x*A+y*z);b[0]=(h*G-k*F+j*E)*s;b[1]=(-d*G+e*F-g*E)*s;b[2]=(r*y-t*x+u*w)*s;b[3]=
(-m*y+p*x-n*w)*s;b[4]=(-f*G+k*B-j*A)*s;b[5]=(c*G-e*B+g*A)*s;b[6]=(-q*y+t*v-u*D)*s;b[7]=(l*y-p*v+n*D)*s;b[8]=(f*F-h*B+j*z)*s;b[9]=(-c*F+d*B-g*z)*s;b[10]=(q*x-r*v+u*C)*s;b[11]=(-l*x+m*v-n*C)*s;b[12]=(-f*E+h*A-k*z)*s;b[13]=(c*E-d*A+e*z)*s;b[14]=(-q*w+r*D-t*C)*s;b[15]=(l*w-m*D+p*C)*s;return b},toRotationMat:function(a,b){b||(b=mat4.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},
toMat3:function(a,b){b||(b=mat3.create());b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[4];b[4]=a[5];b[5]=a[6];b[6]=a[8];b[7]=a[9];b[8]=a[10];return b},toInverseMat3:function(a,b){var c=a[0],d=a[1],e=a[2],g=a[4],f=a[5],h=a[6],k=a[8],j=a[9],l=a[10],m=l*f-h*j,p=-l*g+h*k,n=j*g-f*k,q=c*m+d*p+e*n;if(!q)return null;q=1/q;b||(b=mat3.create());b[0]=m*q;b[1]=(-l*d+e*j)*q;b[2]=(h*d-e*f)*q;b[3]=p*q;b[4]=(l*c-e*k)*q;b[5]=(-h*c+e*g)*q;b[6]=n*q;b[7]=(-j*c+d*k)*q;b[8]=(f*c-d*g)*q;return b},multiply:function(a,b,c){c||(c=
a);var d=a[0],e=a[1],g=a[2],f=a[3],h=a[4],k=a[5],j=a[6],l=a[7],m=a[8],p=a[9],n=a[10],q=a[11],r=a[12],t=a[13],u=a[14];a=a[15];var C=b[0],D=b[1],v=b[2],w=b[3],x=b[4],y=b[5],z=b[6],A=b[7],B=b[8],E=b[9],F=b[10],G=b[11],s=b[12],H=b[13],I=b[14];b=b[15];c[0]=C*d+D*h+v*m+w*r;c[1]=C*e+D*k+v*p+w*t;c[2]=C*g+D*j+v*n+w*u;c[3]=C*f+D*l+v*q+w*a;c[4]=x*d+y*h+z*m+A*r;c[5]=x*e+y*k+z*p+A*t;c[6]=x*g+y*j+z*n+A*u;c[7]=x*f+y*l+z*q+A*a;c[8]=B*d+E*h+F*m+G*r;c[9]=B*e+E*k+F*p+G*t;c[10]=B*g+E*j+F*n+G*u;c[11]=B*f+E*l+F*q+G*a;
c[12]=s*d+H*h+I*m+b*r;c[13]=s*e+H*k+I*p+b*t;c[14]=s*g+H*j+I*n+b*u;c[15]=s*f+H*l+I*q+b*a;return c},multiplyVec3:function(a,b,c){c||(c=b);var d=b[0],e=b[1];b=b[2];c[0]=a[0]*d+a[4]*e+a[8]*b+a[12];c[1]=a[1]*d+a[5]*e+a[9]*b+a[13];c[2]=a[2]*d+a[6]*e+a[10]*b+a[14];return c},multiplyVec4:function(a,b,c){c||(c=b);var d=b[0],e=b[1],g=b[2];b=b[3];c[0]=a[0]*d+a[4]*e+a[8]*g+a[12]*b;c[1]=a[1]*d+a[5]*e+a[9]*g+a[13]*b;c[2]=a[2]*d+a[6]*e+a[10]*g+a[14]*b;c[3]=a[3]*d+a[7]*e+a[11]*g+a[15]*b;return c},translate:function(a,
b,c){var d=b[0],e=b[1];b=b[2];if(!c||a==c)return a[12]=a[0]*d+a[4]*e+a[8]*b+a[12],a[13]=a[1]*d+a[5]*e+a[9]*b+a[13],a[14]=a[2]*d+a[6]*e+a[10]*b+a[14],a[15]=a[3]*d+a[7]*e+a[11]*b+a[15],a;var g=a[0],f=a[1],h=a[2],k=a[3],j=a[4],l=a[5],m=a[6],p=a[7],n=a[8],q=a[9],r=a[10],t=a[11];c[0]=g;c[1]=f;c[2]=h;c[3]=k;c[4]=j;c[5]=l;c[6]=m;c[7]=p;c[8]=n;c[9]=q;c[10]=r;c[11]=t;c[12]=g*d+j*e+n*b+a[12];c[13]=f*d+l*e+q*b+a[13];c[14]=h*d+m*e+r*b+a[14];c[15]=k*d+p*e+t*b+a[15];return c},scale:function(a,b,c){var d=b[0],e=
b[1];b=b[2];if(!c||a==c)return a[0]*=d,a[1]*=d,a[2]*=d,a[3]*=d,a[4]*=e,a[5]*=e,a[6]*=e,a[7]*=e,a[8]*=b,a[9]*=b,a[10]*=b,a[11]*=b,a;c[0]=a[0]*d;c[1]=a[1]*d;c[2]=a[2]*d;c[3]=a[3]*d;c[4]=a[4]*e;c[5]=a[5]*e;c[6]=a[6]*e;c[7]=a[7]*e;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c},rotate:function(a,b,c,d){var e=c[0],g=c[1];c=c[2];var f=Math.sqrt(e*e+g*g+c*c);if(!f)return null;1!=f&&(f=1/f,e*=f,g*=f,c*=f);var h=Math.sin(b),k=Math.cos(b),j=1-k;
b=a[0];var f=a[1],l=a[2],m=a[3],p=a[4],n=a[5],q=a[6],r=a[7],t=a[8],u=a[9],C=a[10],D=a[11],v=e*e*j+k,w=g*e*j+c*h,x=c*e*j-g*h,y=e*g*j-c*h,z=g*g*j+k,A=c*g*j+e*h,B=e*c*j+g*h,e=g*c*j-e*h,g=c*c*j+k;d?a!=d&&(d[12]=a[12],d[13]=a[13],d[14]=a[14],d[15]=a[15]):d=a;d[0]=b*v+p*w+t*x;d[1]=f*v+n*w+u*x;d[2]=l*v+q*w+C*x;d[3]=m*v+r*w+D*x;d[4]=b*y+p*z+t*A;d[5]=f*y+n*z+u*A;d[6]=l*y+q*z+C*A;d[7]=m*y+r*z+D*A;d[8]=b*B+p*e+t*g;d[9]=f*B+n*e+u*g;d[10]=l*B+q*e+C*g;d[11]=m*B+r*e+D*g;return d},rotateX:function(a,b,c){var d=Math.sin(b);
b=Math.cos(b);var e=a[4],g=a[5],f=a[6],h=a[7],k=a[8],j=a[9],l=a[10],m=a[11];c?a!=c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[4]=e*b+k*d;c[5]=g*b+j*d;c[6]=f*b+l*d;c[7]=h*b+m*d;c[8]=e*-d+k*b;c[9]=g*-d+j*b;c[10]=f*-d+l*b;c[11]=h*-d+m*b;return c},rotateY:function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[0],g=a[1],f=a[2],h=a[3],k=a[8],j=a[9],l=a[10],m=a[11];c?a!=c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],
c[15]=a[15]):c=a;c[0]=e*b+k*-d;c[1]=g*b+j*-d;c[2]=f*b+l*-d;c[3]=h*b+m*-d;c[8]=e*d+k*b;c[9]=g*d+j*b;c[10]=f*d+l*b;c[11]=h*d+m*b;return c},rotateZ:function(a,b,c){var d=Math.sin(b);b=Math.cos(b);var e=a[0],g=a[1],f=a[2],h=a[3],k=a[4],j=a[5],l=a[6],m=a[7];c?a!=c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]):c=a;c[0]=e*b+k*d;c[1]=g*b+j*d;c[2]=f*b+l*d;c[3]=h*b+m*d;c[4]=e*-d+k*b;c[5]=g*-d+j*b;c[6]=f*-d+l*b;c[7]=h*-d+m*b;return c},frustum:function(a,b,c,d,
e,g,f){f||(f=mat4.create());var h=b-a,k=d-c,j=g-e;f[0]=2*e/h;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=2*e/k;f[6]=0;f[7]=0;f[8]=(b+a)/h;f[9]=(d+c)/k;f[10]=-(g+e)/j;f[11]=-1;f[12]=0;f[13]=0;f[14]=-(2*g*e)/j;f[15]=0;return f},perspective:function(a,b,c,d,e){a=c*Math.tan(a*Math.PI/360);b*=a;return mat4.frustum(-b,b,-a,a,c,d,e)},ortho:function(a,b,c,d,e,g,f){f||(f=mat4.create());var h=b-a,k=d-c,j=g-e;f[0]=2/h;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=2/k;f[6]=0;f[7]=0;f[8]=0;f[9]=0;f[10]=-2/j;f[11]=0;f[12]=-(a+b)/h;f[13]=
-(d+c)/k;f[14]=-(g+e)/j;f[15]=1;return f},lookAt:function(a,b,c,d){d||(d=mat4.create());var e=a[0],g=a[1];a=a[2];var f=c[0],h=c[1],k=c[2];c=b[1];var j=b[2];if(e==b[0]&&g==c&&a==j)return mat4.identity(d);var l,m,p,n;c=e-b[0];j=g-b[1];b=a-b[2];n=1/Math.sqrt(c*c+j*j+b*b);c*=n;j*=n;b*=n;l=h*b-k*j;k=k*c-f*b;f=f*j-h*c;(n=Math.sqrt(l*l+k*k+f*f))?(n=1/n,l*=n,k*=n,f*=n):f=k=l=0;h=j*f-b*k;m=b*l-c*f;p=c*k-j*l;(n=Math.sqrt(h*h+m*m+p*p))?(n=1/n,h*=n,m*=n,p*=n):p=m=h=0;d[0]=l;d[1]=h;d[2]=c;d[3]=0;d[4]=k;d[5]=m;
d[6]=j;d[7]=0;d[8]=f;d[9]=p;d[10]=b;d[11]=0;d[12]=-(l*e+k*g+f*a);d[13]=-(h*e+m*g+p*a);d[14]=-(c*e+j*g+b*a);d[15]=1;return d},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"}};
quat4={create:function(a){var b=new glMatrixArrayType(4);a&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3]);return b},set:function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},calculateW:function(a,b){var c=a[0],d=a[1],e=a[2];if(!b||a==b)return a[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e)),a;b[0]=c;b[1]=d;b[2]=e;b[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e));return b},inverse:function(a,b){if(!b||a==b)return a[0]*=1,a[1]*=1,a[2]*=1,a;b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=a[3];return b},length:function(a){var b=
a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)},normalize:function(a,b){b||(b=a);var c=a[0],d=a[1],e=a[2],g=a[3],f=Math.sqrt(c*c+d*d+e*e+g*g);if(0==f)return b[0]=0,b[1]=0,b[2]=0,b[3]=0,b;f=1/f;b[0]=c*f;b[1]=d*f;b[2]=e*f;b[3]=g*f;return b},multiply:function(a,b,c){c||(c=a);var d=a[0],e=a[1],g=a[2];a=a[3];var f=b[0],h=b[1],k=b[2];b=b[3];c[0]=d*b+a*f+e*k-g*h;c[1]=e*b+a*h+g*f-d*k;c[2]=g*b+a*k+d*h-e*f;c[3]=a*b-d*f-e*h-g*k;return c},multiplyVec3:function(a,b,c){c||(c=b);var d=b[0],e=b[1],g=
b[2];b=a[0];var f=a[1],h=a[2];a=a[3];var k=a*d+f*g-h*e,j=a*e+h*d-b*g,l=a*g+b*e-f*d,d=-b*d-f*e-h*g;c[0]=k*a+d*-b+j*-h-l*-f;c[1]=j*a+d*-f+l*-b-k*-h;c[2]=l*a+d*-h+k*-f-j*-b;return c},toMat3:function(a,b){b||(b=mat3.create());var c=a[0],d=a[1],e=a[2],g=a[3],f=c+c,h=d+d,k=e+e,j=c*f,l=c*h,c=c*k,m=d*h,d=d*k,e=e*k,f=g*f,h=g*h,g=g*k;b[0]=1-(m+e);b[1]=l-g;b[2]=c+h;b[3]=l+g;b[4]=1-(j+e);b[5]=d-f;b[6]=c-h;b[7]=d+f;b[8]=1-(j+m);return b},toMat4:function(a,b){b||(b=mat4.create());var c=a[0],d=a[1],e=a[2],g=a[3],
f=c+c,h=d+d,k=e+e,j=c*f,l=c*h,c=c*k,m=d*h,d=d*k,e=e*k,f=g*f,h=g*h,g=g*k;b[0]=1-(m+e);b[1]=l-g;b[2]=c+h;b[3]=0;b[4]=l+g;b[5]=1-(j+e);b[6]=d-f;b[7]=0;b[8]=c-h;b[9]=d+f;b[10]=1-(j+m);b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b},slerp:function(a,b,c,d){d||(d=a);var e=c;0>a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]&&(e=-1*c);d[0]=1-c*a[0]+e*b[0];d[1]=1-c*a[1]+e*b[1];d[2]=1-c*a[2]+e*b[2];d[3]=1-c*a[3]+e*b[3];return d},str:function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"}};(function(){function a(){this.canvasElement=this.videoElement=null;errorHandlerType=1;this.fragmentShaderFile="js/fragment.shader";this.vertexShaderFile="js/vertex.shader";this.gl=this.shaderProgram=null;this.seq=this.status=!0;this.counter=0;this.feq=3;this.threeDSwitcher=!0;this.redFilter=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];this.cyanFilter=[0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];this.greenFilter=[0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1];this.magentaFilter=[1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1];this.yellowFilter=[1,
0,0,0,0,1,0,0,0,0,0,0,0,0,0,1];this.blueFilter=[0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1];this.redHalfColorFilter=[0.299,0,0,0,0.587,0,0,0,0.114,0,0,0,0,0,0,1];this.redOptiColorFilter=[0,0,0,0,0.7,0,0,0,0.3,0,0,0,0,0,0,1];this.effectType=this.defaultEffectType=1;this.uFilter0=this.redFilter;this.uFilter1=this.cyanFilter;this.perspectiveMatrix=this.mvMatrix=this.sceneVerticesTextureCoordBuffer1=this.sceneVerticesTextureCoordBuffer0=this.sceneVerticesIndexBuffer=this.sceneVerticesBuffer1=this.sceneVerticesBuffer0=
this.sceneTexture=null;this.oriSceneVertices=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];this.rSceneVertices=[0,-1,0,1,-1,0,1,1,0,0,1,0];this.lSceneVertices=[-1,-1,0,0,-1,0,0,1,0,-1,1,0];this.uSceneVertices=[-1,-1,0,1,-1,0,1,0,0,-1,0,0];this.aSceneVertices=[-1,0,0,1,0,0,1,1,0,-1,1,0];this.sceneVertices1=this.sceneVertices0=this.oriSceneVertices;this.sceneVertexIndices=[0,1,2,0,2,3];this.oriSceneTextureCoordinates=[0,0,1,0,1,1,0,1];this.leftSceneTextureCoordinates=[0,0,0.5,0,0.5,1,0,1];this.rightSceneTextureCoordinates=
[0.5,0,1,0,1,1,0.5,1];this.aboveSceneTextureCoordinates=[0,0.5,1,0.5,1,1,0,1];this.underSceneTextureCoordinates=[0,0,1,0,1,0.5,0,0.5];this.inputType=this.defaultInputType=1;this.currentSceneTextureCoordinates0=this.leftSceneTextureCoordinates;this.currentSceneTextureCoordinates1=this.rightSceneTextureCoordinates}a.prototype.get3DMode=function(){return this.threeDSwitcher};a.prototype.set3DMode=function(a,c){this.threeDSwitcher=a;void 0==c&&(c=!0);c&&this.initProcess()};a.prototype.initProcess=function(){!this.initShaders()&&
this.status&&(this.status=!1);!this.initBuffers()&&this.status&&(this.status=!1);!this.initTexture()&&this.status&&(this.status=!1);!this.initScene()&&this.status&&(this.status=!1)};a.prototype.getStatus=function(){return this.status};a.prototype.getEffectType=function(){return this.effectType};a.prototype.setEffectType=function(a,c){if(this.threeDSwitcher){if(1==a)this.sceneVertices1=this.sceneVertices0=this.oriSceneVertices,this.uFilter0=this.redFilter,this.uFilter1=this.cyanFilter;else if(2==a)this.sceneVertices1=
this.sceneVertices0=this.oriSceneVertices,this.uFilter0=this.greenFilter,this.uFilter1=this.magentaFilter;else if(3==a)this.sceneVertices1=this.sceneVertices0=this.oriSceneVertices,this.uFilter0=this.yellowFilter,this.uFilter1=this.blueFilter;else if(9==a)this.sceneVertices1=this.sceneVertices0=this.oriSceneVertices,this.uFilter0=this.redHalfColorFilter,this.uFilter1=this.cyanFilter;else if(10==a)this.sceneVertices1=this.sceneVertices0=this.oriSceneVertices,this.uFilter0=this.redOptiColorFilter,this.uFilter1=
this.cyanFilter;else if(4==a)this.sceneVertices0=this.rSceneVertices,this.sceneVertices1=this.lSceneVertices;else if(5==a)this.sceneVertices0=this.uSceneVertices,this.sceneVertices1=this.aSceneVertices;else if(6==a||7==a||8==a)this.sceneVertices1=this.sceneVertices0=this.oriSceneVertices;this.effectType=a}else this.effectType=1,this.uFilter0=this.redFilter,this.uFilter1=this.cyanFilter,this.sceneVertices1=this.sceneVertices0=this.oriSceneVertices;void 0==c&&(c=!0);c&&this.initProcess()};a.prototype.getSeqType=
function(){return this.seq};a.prototype.setSeqType=function(a){"boolean"==typeof a&&(this.seq=a)};a.prototype.getInputType=function(){return this.inputType};a.prototype.setInputType=function(a,c){this.threeDSwitcher?(0==a?(this.currentSceneTextureCoordinates0=this.leftSceneTextureCoordinates,this.currentSceneTextureCoordinates1=this.rightSceneTextureCoordinates):1==a?(this.currentSceneTextureCoordinates0=this.leftSceneTextureCoordinates,this.currentSceneTextureCoordinates1=this.rightSceneTextureCoordinates):
2==a&&(this.currentSceneTextureCoordinates0=this.aboveSceneTextureCoordinates,this.currentSceneTextureCoordinates1=this.underSceneTextureCoordinates),this.inputType=a):(this.inputType=1,this.currentSceneTextureCoordinates1=this.currentSceneTextureCoordinates0=this.oriSceneTextureCoordinates);void 0==c&&(c=!0);c&&this.initProcess()};a.prototype.init=function(a,c){try{if(this.canvasElement=document.getElementById(a),this.videoElement=document.getElementById(c),this.initWebGL(),this.set3DMode(this.threeDSwitcher),
this.gl)this.gl.clearColor(0,0,0,1),this.gl.clearDepth(1),this.gl.disable(this.gl.DEPTH_TEST),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE),this.gl.depthFunc(this.gl.LEQUAL),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);else throw"Unable to initialize WebGL. Your browser may not support it.";}catch(d){this.errorHandler(errorHandlerType,d)}};a.prototype.initWebGL=function(){try{this.gl=this.canvasElement.getContext("webgl")||this.canvasElement.getContext("experimental-webgl");
this.setGLViewport(this.canvasElement);if(!this.gl)throw"Unable to initialize WebGL. Your browser may not support it.";return!0}catch(a){this.errorHandler(errorHandlerType,a)}};a.prototype.setGLViewport=function(a){this.gl.viewportWidth=a.width;this.gl.viewportHeight=a.height;this.initViewport()};a.prototype.initViewport=function(){this.gl.viewport(0,0,this.gl.viewportWidth,this.gl.viewportHeight);return!0};a.prototype.initShaders=function(){try{var a=this.getShader(this.fragmentShaderFile),c=this.getShader(this.vertexShaderFile);
this.shaderProgram=this.gl.createProgram();this.gl.attachShader(this.shaderProgram,c);this.gl.attachShader(this.shaderProgram,a);this.gl.linkProgram(this.shaderProgram);if(!this.gl.getProgramParameter(this.shaderProgram,this.gl.LINK_STATUS))throw"Unable to initialize the shader program.";this.gl.useProgram(this.shaderProgram);this.shaderProgram.uThreeDSwitcher=this.gl.getUniformLocation(this.shaderProgram,"u3DSwitcher");this.shaderProgram.uEffectType=this.gl.getUniformLocation(this.shaderProgram,
"uEffectType");this.shaderProgram.uSeq=this.gl.getUniformLocation(this.shaderProgram,"uSeq");this.shaderProgram.uStageHeight=this.gl.getUniformLocation(this.shaderProgram,"uStageHeight");this.shaderProgram.uStageWidth=this.gl.getUniformLocation(this.shaderProgram,"uStageWidth");this.shaderProgram.uFilter0=this.gl.getUniformLocation(this.shaderProgram,"uFilter0");this.shaderProgram.uFilter1=this.gl.getUniformLocation(this.shaderProgram,"uFilter1");this.shaderProgram.pMatrixUniform=this.gl.getUniformLocation(this.shaderProgram,
"uPMatrix");this.shaderProgram.mvMatrixUniform=this.gl.getUniformLocation(this.shaderProgram,"uMVMatrix");this.shaderProgram.samplerUniform=this.gl.getUniformLocation(this.shaderProgram,"uSampler");this.shaderProgram.vertexPositionAttribute=this.gl.getAttribLocation(this.shaderProgram,"aVertexPosition");this.shaderProgram.textureCoordAttribute0=this.gl.getAttribLocation(this.shaderProgram,"aTextureCoord0");this.shaderProgram.textureCoordAttribute1=this.gl.getAttribLocation(this.shaderProgram,"aTextureCoord1");
return!0}catch(d){this.errorHandler(errorHandlerType,d)}};a.prototype.getShader=function(a){try{var c=this.a(a,{},"post",!1,!1);if(!c)return null;var d;if(a==this.fragmentShaderFile)d=this.gl.createShader(this.gl.FRAGMENT_SHADER);else if(a==this.vertexShaderFile)d=this.gl.createShader(this.gl.VERTEX_SHADER);else return null;this.gl.shaderSource(d,c);this.gl.compileShader(d);return!this.gl.getShaderParameter(d,this.gl.COMPILE_STATUS)?null:d}catch(e){this.errorHandler(errorHandlerType,e)}};a.prototype.initBuffers=
function(){try{this.sceneVerticesBuffer0=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sceneVerticesBuffer0);this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.sceneVertices0),this.gl.STATIC_DRAW);if((4==this.effectType||5==this.effectType)&&this.threeDSwitcher)this.sceneVerticesBuffer1=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sceneVerticesBuffer1),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.sceneVertices1),this.gl.STATIC_DRAW);
this.sceneVerticesIndexBuffer=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sceneVerticesIndexBuffer);this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.sceneVertexIndices),this.gl.STATIC_DRAW);this.threeDSwitcher?(this.sceneVerticesTextureCoordBuffer0=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sceneVerticesTextureCoordBuffer0),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.currentSceneTextureCoordinates0),this.gl.STATIC_DRAW),
this.gl.vertexAttribPointer(this.shaderProgram.textureCoordAttribute0,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.shaderProgram.textureCoordAttribute0),this.sceneVerticesTextureCoordBuffer1=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sceneVerticesTextureCoordBuffer1),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.currentSceneTextureCoordinates1),this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.shaderProgram.textureCoordAttribute1,2,this.gl.FLOAT,
!1,0,0),this.gl.enableVertexAttribArray(this.shaderProgram.textureCoordAttribute1)):(this.sceneVerticesTextureCoordBuffer0=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sceneVerticesTextureCoordBuffer0),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.currentSceneTextureCoordinates0),this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.shaderProgram.textureCoordAttribute0,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.shaderProgram.textureCoordAttribute0));
this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,null);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null);return!0}catch(a){this.errorHandler(errorHandlerType,a)}};a.prototype.initScene=function(){try{return this.mvMatrix=mat4.create(),this.perspectiveMatrix=mat4.create(),mat4.perspective(90,1,0.1,100,this.perspectiveMatrix),mat4.identity(this.mvMatrix),mat4.translate(this.mvMatrix,[0,0,-1]),this.gl.uniformMatrix4fv(this.shaderProgram.pMatrixUniform,!1,this.perspectiveMatrix),this.gl.uniformMatrix4fv(this.shaderProgram.mvMatrixUniform,
!1,this.mvMatrix),this.gl.uniform1i(this.shaderProgram.uThreeDSwitcher,this.threeDSwitcher),this.gl.uniform1i(this.shaderProgram.uEffectType,this.effectType),this.gl.uniform1i(this.shaderProgram.uSeq,this.seq),this.gl.uniform1f(this.shaderProgram.uStageHeight,this.gl.viewportHeight),this.gl.uniform1f(this.shaderProgram.uStageWidth,this.gl.viewportWidth),this.gl.uniformMatrix4fv(this.shaderProgram.uFilter0,!1,this.uFilter0),this.gl.uniformMatrix4fv(this.shaderProgram.uFilter1,!1,this.uFilter1),!0}catch(a){this.errorHandler(errorHandlerType,
a)}};a.prototype.initTexture=function(){try{return this.gl.activeTexture(this.gl.TEXTURE0),this.sceneTexture=this.gl.createTexture(),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.sceneTexture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,
this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.uniform1i(this.shaderProgram.samplerUniform,0),!0}catch(a){this.errorHandler(errorHandlerType,a)}};a.prototype.updateTexture=function(a){try{return a?(this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,a),!0):this.videoElement?(this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,this.videoElement),!0):!1}catch(c){this.errorHandler(errorHandlerType,c)}};a.prototype.drawScene=
function(a){try{if(!this.updateTexture(a))return!1;this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sceneVerticesBuffer0);this.gl.vertexAttribPointer(this.shaderProgram.vertexPositionAttribute,3,this.gl.FLOAT,!1,0,0);this.gl.enableVertexAttribArray(this.shaderProgram.vertexPositionAttribute);this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sceneVerticesIndexBuffer);8==this.effectType?(this.counter++,1==this.counter/this.feq&&(this.counter=this.feq),0==Math.ceil(this.counter/this.feq)%2?this.gl.uniform1i(this.shaderProgram.uSeq,
this.seq):this.gl.uniform1i(this.shaderProgram.uSeq,!this.seq)):this.gl.uniform1i(this.shaderProgram.uSeq,this.seq);this.gl.drawElements(this.gl.TRIANGLES,this.sceneVertexIndices.length,this.gl.UNSIGNED_SHORT,0);if((4==this.effectType||5==this.effectType)&&this.threeDSwitcher)this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sceneVerticesBuffer1),this.gl.vertexAttribPointer(this.shaderProgram.vertexPositionAttribute,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.shaderProgram.vertexPositionAttribute),
this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sceneVerticesIndexBuffer),this.gl.uniform1i(this.shaderProgram.uSeq,!this.seq),this.gl.drawElements(this.gl.TRIANGLES,this.sceneVertexIndices.length,this.gl.UNSIGNED_SHORT,0);return!0}catch(c){this.errorHandler(errorHandlerType,c)}};a.prototype.a=function(a,c,d,e,g){try{var f=this,h="";if(!d||"post"!=d.toLowerCase()&&"get"!=d.toLowerCase())d="get";if(!c||c instanceof Object)c={};!1!=g&&!0!=g&&(g=!0);var k;k=!1!=e&&!0!=e?!0:!0==e?!0:!1;if("undefined"==
typeof jQuery){var j;e="";try{j=new XMLHttpRequest}catch(l){try{j=new ActiveXObject("Microsoft.XMLHTTP")}catch(m){return f.errorHandler(errorHandlerType,"Your browser does not support XMLHTTP!"),null}}for(var p in c)if("function"==typeof c[p])c[p]();else e+=p+"="+c[p]+"&";"get"==d&&("undefined"!==e&&null!=e&&(a+="?"+e),e=null);j.onreadystatechange=function(){4==j.readyState&&200==j.status&&(h=j.responseText)};j.open(d,a,k);j.send(e)}else $.ajax({type:d,url:a,async:e,data:c,beforeSend:function(){},
success:function(a){h=a},complete:function(){},error:function(){f.errorHandler(errorHandlerType,"ajax error");return null}});return h}catch(n){this.errorHandler(errorHandlerType,n)}};a.prototype.errorHandler=function(a,c,d){try{a||(a=!errorHandlerType?0:errorHandlerType);var e="";c&&("object"==typeof c?(c.line&&(e+=" - line : "+c.line),c.lineNumber&&(e+=" - line : "+c.lineNumber),c.message&&(e+=" - Message : "+c.message)):e+=" - Message : "+c);d&&(e+=d);var g=new Date;if(!g)throw"Initailize the Date()-Object failed.";
var f="!Error!<br /> -Time : "+g.getFullYear()+"/"+(g.getMonth()+1)+"/"+g.getDate()+"  "+g.getHours()+":"+g.getMinutes()+":"+g.getSeconds(),f=f+("<br />"+e);0==a?alert(f):1==a&&console.log(f)}catch(h){alert(arguments.callee.name+" - line : "+h.line+" - message : "+h.message)}};window.__=new a})();